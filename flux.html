<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Interconnexions & Flux - Mix Électrique</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Feuille de style principale -->
  <link rel="stylesheet" href="style.css" />

  <!-- D3.js v7 -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
  <main class="page">
    <section class="viz-section" style="margin-top: 28px;">
      <div class="viz-left" style="flex: 1.6;">
        <div>
          <div class="section-title">
            <span id="fluxTitlePrefix">Interconnexions :</span>
            <span id="fluxTitleDate">Chargement...</span>
          </div>
          <div class="section-subtitle">Visualisation des échanges transfrontaliers et de l'intensité carbone française.</div>
        </div>

        <div class="story-controls">
            <button class="btn-story" data-target="event1">❄️ Pic Hiver</button>
            <button class="btn-story" data-target="event2">☀️ Creux Été</button>
            <button class="btn-story" data-target="event3">⚡ Record Export</button>
        </div>

        <div class="legend" style="margin-bottom: 5px;">
            <div class="legend-item">
                    <span style="color:#2ecc71; font-weight:bold; font-size:1.2em;">&#8594;</span> 
                    <span>Export (Vente)</span>
                </div>
                <div class="legend-item">
                    <span style="color:#e74c3c; font-weight:bold; font-size:1.2em;">&#8594;</span> 
                    <span>Import (Achat)</span>
                </div>
                <div class="legend-item" style="margin-left:15px;">
                    <span class="legend-color-flux" style="background: linear-gradient(90deg, #2ecc71, #f1c40f, #e74c3c); width: 40px; border-radius:2px;"></span>
                    France (Intensité CO2)
            </div>
        </div>

        <div id="flux-chart" class="viz-container">
            <div id="tooltip-flux"></div>
        </div>

        <div class="controls" style="margin-top:15px;">
          <div class="controls-left">
            <span class="tag">Mode</span>
            <button id="modeDayFlux" class="toggle-btn active">Jour</button>
            <button id="modeMonthFlux" class="toggle-btn">Mois</button>
          </div>
          <div class="controls-right">
            <span id="sliderLabelFlux" class="slider-label">Jour : -</span>
            <input type="range" id="timeSliderFlux" min="0" max="0" value="0" style="width: 200px;" />
          </div>
        </div>
      </div>

      <aside class="viz-right" style="flex: 1;">
        <div class="explanation-header">Analyse des flux</div>
        <div class="explanation-body" id="fluxAnalysisText">Chargement des données...</div>
        <br>

        <div class="metric-row">
            <div class="metric-label">Solde Commercial (Total sur la journée)</div>
            <div class="metric-value" id="fluxMetricBalance">-</div>
        </div>
        <div class="metric-row">
            <div class="metric-label">Partenaire Principal (Vol. Max)</div>
            <div class="metric-value" id="fluxMetricPartner">-</div>
        </div>
        <div class="metric-row">
            <div class="metric-label">Intensité Carbone (Prod. FR)</div>
            <div class="metric-value" id="fluxMetricCO2">-</div>
        </div>

        <div id="history-chart-container">
            <div class="explanation-header" style="font-size:0.8rem; margin-bottom:5px;">Contexte (Échange sur les 7 derniers jours)</div>
            <svg id="history-chart" width="100%" height="80"></svg>
        </div>

        <ul class="bullet-list" id="fluxBulletList">
            <li><strong>Animation :</strong> La vitesse des particules représente l'intensité des échanges.</li>
            <li><strong>Couleur Pays :</strong> La France change selon son CO2. Les voisins deviennent <span style="color:#e74c3c">rouges</span> si on importe de l'énergie <span style="color:#2ecc71">verts</span> si on en exporte.</li>
        </ul>
      </aside>
    </section>
  </main>

  <script src="js/viz_flux.js"></script>
</body>
</html>